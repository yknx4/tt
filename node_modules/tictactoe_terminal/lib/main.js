'use strict';

var _tictactoe_core = require('tictactoe_core');

var _tictactoe_core2 = _interopRequireDefault(_tictactoe_core);

var _Player = require('tictactoe_core/lib/Player');

var _Player2 = _interopRequireDefault(_Player);

var _prompt = require('prompt');

var _prompt2 = _interopRequireDefault(_prompt);

var _readlineSync = require('readline-sync');

var _readlineSync2 = _interopRequireDefault(_readlineSync);

var _underscore = require('underscore');

var _underscore2 = _interopRequireDefault(_underscore);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

(function () {
  var defaults = { main: main };
  function main() {
    var playerPromptSchema = {
      properties: {
        firstPlayerName: {
          required: true,
          description: 'First player name: ',
          default: 'Player 1'
        },
        secondPlayerName: {
          required: true,
          description: 'Second player name: ',
          default: 'Player 2'
        }
      }
    };

    var score = {};
    var players = [];
    var turn = 1;

    var finished;
    var game = void 0;
    var board = void 0;
    initializeBoard();

    _prompt2.default.start();
    _prompt2.default.get(playerPromptSchema, function (err, result) {
      if (err) {
        console.log(err.message);
      }
      console.log('Players:');
      console.log('  First Player: ' + result.firstPlayerName);
      console.log('  Second Player: ' + result.secondPlayerName);
      createPlayer('X', result.firstPlayerName);
      createPlayer('O', result.secondPlayerName);
      playNextTurn();
    });

    function playNextTurn() {
      if (finished) {
        promptNewGame();
        return;
      }
      var turnData = nextTurn();
      console.log(turnData.message);
      var x = _readlineSync2.default.questionInt('Column: ', { limit: function limit(number) {
          return number > 0 && number < board.width;
        } });
      var y = _readlineSync2.default.questionInt('Row: ', { limit: function limit(number) {
          return number > 0 && number < board.height;
        } });
      try {
        turnData.player.play(x, y);
      } catch (e) {
        console.log(e.message);
        turn--;
      } finally {
        drawBoard();
        playNextTurn();
      }
    }

    function createPlayer(id, name) {
      var player = new _Player2.default(id, name);
      players.push(player);
      game.addPlayer(player);
      score[id] = 0;
    }

    function nextTurn() {
      turn = (turn + 1) % 2;
      var player = players[turn];
      return { message: player.name + ' (' + player.id + ') turn', player: player };
    }

    function drawBoard() {
      var board = game.board;
      process.stdout.write("\n");
      for (var x = board.width; x !== 0; x--) {
        for (var y = 1; y <= board.height; y++) {
          var cell = board.getCell(x - 1, y - 1) || '_';
          process.stdout.write(cell + '\t');
        }
        process.stdout.write("\n");
      }
      process.stdout.write("\n");
    }

    function promptNewGame() {
      if (!_readlineSync2.default.keyInYN('Do you want to play another one?')) {
        process.exit();
        return;
      }
      initializeBoard();
      playNextTurn();
    }

    function onWinnerListener(player) {
      finished = true;
      console.log('');
      if (player === null) {
        console.log("Game was a draw");
      } else {
        console.log(player.name + ' (' + player.id + ') wins.');
        score[player.id]++;
        _underscore2.default.each(players, printScore);
      }
      console.log('');
    }

    function printScore(player) {
      console.log(player.name + ' wins: ' + score[player.id]);
    }

    function initializeBoard() {
      finished = false;
      game = _tictactoe_core2.default.default();
      board = game.board;
      game.onWinnerListener = onWinnerListener;
      if (players.length > 0) {
        _underscore2.default.each(players, function (player) {
          game.addPlayer(player);
        });
      }
    }
  }
  exports.default = defaults;

  if (!module.parent) {
    defaults.main(process.argv[2]);
  }
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tYWluLmpzIl0sIm5hbWVzIjpbImRlZmF1bHRzIiwibWFpbiIsInBsYXllclByb21wdFNjaGVtYSIsInByb3BlcnRpZXMiLCJmaXJzdFBsYXllck5hbWUiLCJyZXF1aXJlZCIsImRlc2NyaXB0aW9uIiwiZGVmYXVsdCIsInNlY29uZFBsYXllck5hbWUiLCJzY29yZSIsInBsYXllcnMiLCJ0dXJuIiwiZmluaXNoZWQiLCJnYW1lIiwiYm9hcmQiLCJpbml0aWFsaXplQm9hcmQiLCJzdGFydCIsImdldCIsImVyciIsInJlc3VsdCIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwiY3JlYXRlUGxheWVyIiwicGxheU5leHRUdXJuIiwicHJvbXB0TmV3R2FtZSIsInR1cm5EYXRhIiwibmV4dFR1cm4iLCJ4IiwicXVlc3Rpb25JbnQiLCJsaW1pdCIsIm51bWJlciIsIndpZHRoIiwieSIsImhlaWdodCIsInBsYXllciIsInBsYXkiLCJlIiwiZHJhd0JvYXJkIiwiaWQiLCJuYW1lIiwicHVzaCIsImFkZFBsYXllciIsInByb2Nlc3MiLCJzdGRvdXQiLCJ3cml0ZSIsImNlbGwiLCJnZXRDZWxsIiwia2V5SW5ZTiIsImV4aXQiLCJvbldpbm5lckxpc3RlbmVyIiwiZWFjaCIsInByaW50U2NvcmUiLCJsZW5ndGgiLCJleHBvcnRzIiwibW9kdWxlIiwicGFyZW50IiwiYXJndiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFDQSxDQUFDLFlBQVc7QUFDVixNQUFJQSxXQUFXLEVBQUNDLE1BQU1BLElBQVAsRUFBZjtBQUNBLFdBQVNBLElBQVQsR0FBZ0I7QUFDZCxRQUFJQyxxQkFBcUI7QUFDdkJDLGtCQUFZO0FBQ1ZDLHlCQUFpQjtBQUNmQyxvQkFBVSxJQURLO0FBRWZDLHVCQUFhLHFCQUZFO0FBR2ZDLG1CQUFTO0FBSE0sU0FEUDtBQU1WQywwQkFBa0I7QUFDaEJILG9CQUFVLElBRE07QUFFaEJD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LFNBQUwsQ0FBZVAsTUFBZjtBQUNELFNBRkQ7QUFHRDtBQUNGO0FBQ0Y7QUFDRG1CLFVBQVEvQyxPQUFSLEdBQWtCUCxRQUFsQjs7QUFFQSxNQUFJLENBQUN1RCxPQUFPQyxNQUFaLEVBQW9CO0FBQ2xCeEQsYUFBU0MsSUFBVCxDQUFjMEMsUUFBUWMsSUFBUixDQUFhLENBQWIsQ0FBZDtBQUNEO0FBQ0YsQ0FySUQiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0aWN0YWN0b2VDb3JlIGZyb20gJ3RpY3RhY3RvZV9jb3JlJ1xuaW1wb3J0IFBsYXllciBmcm9tICd0aWN0YWN0b2VfY29yZS9saWIvUGxheWVyJ1xuaW1wb3J0IHByb21wdCBmcm9tICdwcm9tcHQnXG5pbXBvcnQgcmVhZGxpbmVTeW5jIGZyb20gJ3JlYWRsaW5lLXN5bmMnXG5pbXBvcnQgXyBmcm9tICd1bmRlcnNjb3JlJ1xuKGZ1bmN0aW9uKCkge1xuICBsZXQgZGVmYXVsdHMgPSB7bWFpbjogbWFpbn1cbiAgZnVuY3Rpb24gbWFpbigpIHtcbiAgICBsZXQgcGxheWVyUHJvbXB0U2NoZW1hID0ge1xuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBmaXJzdFBsYXllck5hbWU6IHtcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpcnN0IHBsYXllciBuYW1lOiAnLFxuICAgICAgICAgIGRlZmF1bHQ6ICdQbGF5ZXIgMSdcbiAgICAgICAgfSxcbiAgICAgICAgc2Vjb25kUGxheWVyTmFtZToge1xuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU2Vjb25kIHBsYXllciBuYW1lOiAnLFxuICAgICAgICAgIGRlZmF1bHQ6ICdQbGF5ZXIgMidcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBzY29yZSA9IHt9XG4gICAgbGV0IHBsYXllcnMgPSBbXVxuICAgIGxldCB0dXJuID0gMVxuXG4gICAgdmFyIGZpbmlzaGVkXG4gICAgbGV0IGdhbWVcbiAgICBsZXQgYm9hcmRcbiAgICBpbml0aWFsaXplQm9hcmQoKVxuXG4gICAgcHJvbXB0LnN0YXJ0KCk7XG4gICAgcHJvbXB0LmdldChwbGF5ZXJQcm9tcHRTY2hlbWEsIGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKVxuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coJ1BsYXllcnM6Jyk7XG4gICAgICBjb25zb2xlLmxvZygnICBGaXJzdCBQbGF5ZXI6ICcgKyByZXN1bHQuZmlyc3RQbGF5ZXJOYW1lKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgIFNlY29uZCBQbGF5ZXI6ICcgKyByZXN1bHQuc2Vjb25kUGxheWVyTmFtZSk7XG4gICAgICBjcmVhdGVQbGF5ZXIoJ1gnLCByZXN1bHQuZmlyc3RQbGF5ZXJOYW1lKVxuICAgICAgY3JlYXRlUGxheWVyKCdPJywgcmVzdWx0LnNlY29uZFBsYXllck5hbWUpXG4gICAgICBwbGF5TmV4dFR1cm4oKVxuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBwbGF5TmV4dFR1cm4oKSB7XG4gICAgICBpZiAoZmluaXNoZWQpIHtcbiAgICAgICAgcHJvbXB0TmV3R2FtZSgpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgbGV0IHR1cm5EYXRhID0gbmV4dFR1cm4oKVxuICAgICAgY29uc29sZS5sb2codHVybkRhdGEubWVzc2FnZSk7XG4gICAgICBsZXQgeCA9IHJlYWRsaW5lU3luYy5xdWVzdGlvbkludCgnQ29sdW1uOiAnLCB7bGltaXQ6IG51bWJlciA9PiB7XG4gICAgICAgIHJldHVybiBudW1iZXIgPiAwICYmIG51bWJlciA8IGJvYXJkLndpZHRoXG4gICAgICB9fSlcbiAgICAgIGxldCB5ID0gcmVhZGxpbmVTeW5jLnF1ZXN0aW9uSW50KCdSb3c6ICcsIHtsaW1pdDogbnVtYmVyID0+IHtcbiAgICAgICAgcmV0dXJuIG51bWJlciA+IDAgJiYgbnVtYmVyIDwgYm9hcmQuaGVpZ2h0XG4gICAgICB9fSlcbiAgICAgIHRyeSB7XG4gICAgICAgIHR1cm5EYXRhLnBsYXllci5wbGF5KHgsIHkpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUubWVzc2FnZSk7XG4gICAgICAgIHR1cm4tLVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgZHJhd0JvYXJkKClcbiAgICAgICAgcGxheU5leHRUdXJuKClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVQbGF5ZXIoaWQsIG5hbWUpIHtcbiAgICAgIGxldCBwbGF5ZXIgPSBuZXcgUGxheWVyKGlkLCBuYW1lKVxuICAgICAgcGxheWVycy5wdXNoKHBsYXllcilcbiAgICAgIGdhbWUuYWRkUGxheWVyKHBsYXllcilcbiAgICAgIHNjb3JlW2lkXSA9IDBcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXh0VHVybigpIHtcbiAgICAgIHR1cm4gPSAodHVybiArIDEpICUgMlxuICAgICAgbGV0IHBsYXllciA9IHBsYXllcnNbdHVybl1cbiAgICAgIHJldHVybiB7bWVzc2FnZTogYCR7cGxheWVyLm5hbWV9ICgke3BsYXllci5pZH0pIHR1cm5gLCBwbGF5ZXI6IHBsYXllcn1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkcmF3Qm9hcmQoKSB7XG4gICAgICBsZXQgYm9hcmQgPSBnYW1lLmJvYXJkXG4gICAgICBwcm9jZXNzLnN0ZG91dC53cml0ZShcIlxcblwiKTtcbiAgICAgIGZvciAobGV0IHggPSBib2FyZC53aWR0aDsgeCAhPT0gMDsgeC0tKSB7XG4gICAgICAgIGZvciAobGV0IHkgPSAxOyB5IDw9IGJvYXJkLmhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgbGV0IGNlbGwgPSBib2FyZC5nZXRDZWxsKHggLSAxLCB5IC0gMSkgfHwgJ18nXG4gICAgICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoYCR7Y2VsbH1cXHRgKTtcbiAgICAgICAgfVxuICAgICAgICBwcm9jZXNzLnN0ZG91dC53cml0ZShcIlxcblwiKTtcbiAgICAgIH1cbiAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKFwiXFxuXCIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByb21wdE5ld0dhbWUoKSB7XG4gICAgICBpZiAoIXJlYWRsaW5lU3luYy5rZXlJbllOKCdEbyB5b3Ugd2FudCB0byBwbGF5IGFub3RoZXIgb25lPycpKSB7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgpO1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGluaXRpYWxpemVCb2FyZCgpXG4gICAgICBwbGF5TmV4dFR1cm4oKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uV2lubmVyTGlzdGVuZXIocGxheWVyKSB7XG4gICAgICBmaW5pc2hlZCA9IHRydWVcbiAgICAgIGNvbnNvbGUubG9nKCcnKTtcbiAgICAgIGlmIChwbGF5ZXIgPT09IG51bGwpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJHYW1lIHdhcyBhIGRyYXdcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhgJHtwbGF5ZXIubmFtZX0gKCR7cGxheWVyLmlkfSkgd2lucy5gKVxuICAgICAgICBzY29yZVtwbGF5ZXIuaWRdKytcbiAgICAgICAgXy5lYWNoKHBsYXllcnMsIHByaW50U2NvcmUpXG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZygnJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJpbnRTY29yZShwbGF5ZXIpIHtcbiAgICAgIGNvbnNvbGUubG9nKGAke3BsYXllci5uYW1lfSB3aW5zOiAke3Njb3JlW3BsYXllci5pZF19YCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdGlhbGl6ZUJvYXJkKCkge1xuICAgICAgZmluaXNoZWQgPSBmYWxzZVxuICAgICAgZ2FtZSA9IHRpY3RhY3RvZUNvcmUuZGVmYXVsdCgpXG4gICAgICBib2FyZCA9IGdhbWUuYm9hcmRcbiAgICAgIGdhbWUub25XaW5uZXJMaXN0ZW5lciA9IG9uV2lubmVyTGlzdGVuZXJcbiAgICAgIGlmIChwbGF5ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgXy5lYWNoKHBsYXllcnMsIGZ1bmN0aW9uKHBsYXllcikge1xuICAgICAgICAgIGdhbWUuYWRkUGxheWVyKHBsYXllcilcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZXhwb3J0cy5kZWZhdWx0ID0gZGVmYXVsdHNcblxuICBpZiAoIW1vZHVsZS5wYXJlbnQpIHtcbiAgICBkZWZhdWx0cy5tYWluKHByb2Nlc3MuYXJndlsyXSk7XG4gIH1cbn0pKCk7XG4iXX0=
//# sourceMappingURL=main.js.map